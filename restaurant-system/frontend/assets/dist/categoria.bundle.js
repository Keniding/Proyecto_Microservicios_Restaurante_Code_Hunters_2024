(()=>{"use strict";"http://".concat(window.location.hostname,":8000/api"),"http://".concat(window.location.hostname,":8000/auth");var e={apiBaseUrl:"http://".concat(window.location.hostname,":8000/api")};"http://".concat(window.location.hostname,":8000/auth"),document.addEventListener("DOMContentLoaded",(function(){var t=1;fetch("".concat(e.apiBaseUrl).concat("/categories")).then((function(e){return e.json()})).then((function(n){var o=document.getElementById("categoryTableBody"),a=document.getElementById("pagination");!function r(c){o.innerHTML="";var i=10*(c-1),d=i+10;n.slice(i,d).forEach((function(t){var n=document.createElement("tr");n.setAttribute("data-id",t.id);var a=document.createElement("td");a.textContent=t.id,n.appendChild(a);var r=document.createElement("td");r.textContent=t.nombre,n.appendChild(r);var c=document.createElement("td"),i=document.createElement("button");i.textContent="Editar",i.addEventListener("click",(function(){return function(t){var n=document.querySelector('tr[data-id="'.concat(t,'"]'));if(n){var o=n.querySelector("td:last-child");if(o){document.querySelectorAll('[id^="edit-container-"]').forEach((function(e){return e.remove()}));var a=document.createElement("div");a.id="edit-container-".concat(t),a.style.margin="20px";var r=document.createElement("input");r.type="text",r.placeholder="Nuevo nombre de categoría",r.id="category-name-".concat(t),r.classList.add("input-button-style");var c=document.createElement("button");c.innerText="Guardar",c.style.background="purple",c.onclick=function(){var n=r.value;n?function(t,n){var o="/category/".concat(t);fetch("".concat(e.apiBaseUrl).concat(o),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({nombre:n})}).then((function(e){e.ok?(console.log("Categoría editada con éxito"),location.reload()):console.error("Error al editar la categoría")})).catch((function(e){return console.error("Error al editar la categoría:",e)}))}(t,n):alert("El nombre no puede estar vacío")},a.appendChild(r),a.appendChild(c),o.appendChild(a)}else console.error("Celda de acción no encontrada.")}else console.error("Fila no encontrada para el id:",t)}(t.id)})),c.appendChild(i);var d=document.createElement("button");d.textContent="Eliminar",d.addEventListener("click",(function(){return n=t.id,o="/foodForCategory/".concat(n),a="/category/".concat(n),void fetch("".concat(e.apiBaseUrl).concat(o)).then((function(e){return e.json()})).then((function(t){t&&t.length>0?alert("No se puede eliminar esta categoría porque tiene dependencias."):fetch("".concat(e.apiBaseUrl).concat(a),{method:"DELETE"}).then((function(e){e.ok?(console.log("Categoría eliminada con éxito"),location.reload()):console.error("Error al eliminar la categoría")})).catch((function(e){return console.error("Error al eliminar la categoría:",e)}))})).catch((function(e){return console.error("Error al comprobar dependencias:",e)}));var n,o,a})),c.appendChild(d),n.appendChild(c),o.appendChild(n)})),function(){a.innerHTML="";for(var e=Math.ceil(n.length/10),o=function(e){var n=document.createElement("button");n.textContent=e,n.addEventListener("click",(function(){r(t=e)})),e===t&&n.classList.add("active"),a.appendChild(n)},c=1;c<=e;c++)o(c)}()}(t)})).catch((function(e){return console.error("Error al obtener los datos:",e)}))})),document.getElementById("addButton").addEventListener("click",(function(){var t={nombre:document.getElementById("categoryName").value},n="".concat(e.apiBaseUrl).concat("/category"),o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};fetch(n,o).then((function(e){return e.json()})).then((function(e){e.success?(location.reload(),console.log("Categoría creada exitosamente")):console.error("Error al crear la categoría:",e.error)})).catch((function(e){console.error("Error:",e)}))}))})();